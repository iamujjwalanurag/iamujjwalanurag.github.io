<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Language Intelligence Engine v200</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{
  font-family: system-ui, sans-serif;
  background:#f2f4f7;
  padding:20px;
}
.app{
  max-width:1100px;
  margin:auto;
  background:#fff;
  padding:20px;
  border-radius:10px;
}
h1,h2{text-align:center;}
p.sub{text-align:center;font-size:14px;color:#555;}
.notice{
  background:#eef3ff;
  padding:12px;
  border-radius:6px;
  font-size:13px;
}
textarea,input,select,button{
  width:100%;
  padding:12px;
  margin-top:8px;
  font-size:15px;
}
button{
  background:#000;
  color:#fff;
  border:none;
  cursor:pointer;
}
.card{
  background:#fafafa;
  padding:12px;
  border-radius:6px;
  margin-top:12px;
}
table{
  width:100%;
  border-collapse:collapse;
  margin-top:12px;
}
th,td{
  padding:10px;
  border-bottom:1px solid #ddd;
  font-size:14px;
}
.good{color:#2e7d32;}
.mid{color:#f9a825;}
.low{color:#c62828;}
.small{font-size:13px;color:#666;}
</style>
</head>

<body>

<div class="app">

<h1>Language Intelligence Engine</h1>
<p class="sub">Version 200 Â· Operational Stability</p>

<div class="notice">
Tracks improvement trends in expression readiness.  
No ranking. No English scoring. No embarrassment.
</div>

<hr>

<h2>Participant Session</h2>

<input id="pid" placeholder="Participant ID (required)">
<textarea id="response" placeholder="Describe a responsibility you handled."></textarea>
<button onclick="evaluate()">Submit Session</button>

<div id="privateFeedback"></div>

<hr>

<h2>Trainer View (Trend Summary)</h2>

<table>
<thead>
<tr>
<th>Participant</th>
<th>Recall Trend</th>
<th>Precision Trend</th>
<th>Overall Status</th>
</tr>
</thead>
<tbody id="trainerTable"></tbody>
</table>

</div>

<script>
/* ================= CORE DATA ================= */

const weakWords={
  "do":"handle","did":"handled","thing":"task","things":"responsibilities",
  "make":"create","fix":"resolve","help":"assist","get":"obtain",
  "work":"execute","worked":"contributed"
};

let startTime=null;
let history=JSON.parse(localStorage.getItem("li-history"))||{};

/* ================= TIMER ================= */
response.addEventListener("focus",()=>{
  if(!startTime) startTime=Date.now();
});

/* ================= EVALUATE ================= */
function evaluate(){
  const id=pid.value.trim();
  const text=response.value.trim().toLowerCase();
  if(!id||!text||!startTime)return;

  const time=(Date.now()-startTime)/1000;
  const words=text.split(/\s+/);

  let weakCount=0;
  words.forEach(w=>{if(weakWords[w])weakCount++;});

  const recall=time<4?"Stable":time<8?"Moderate":"Unstable";
  const precision=weakCount===0?"Clear":weakCount<=2?"Developing":"Weak";

  if(!history[id])history[id]=[];
  history[id].push({recall,precision});
  localStorage.setItem("li-history",JSON.stringify(history));

  privateFeedback.innerHTML=`
    <div class="card">
      <b>Private Feedback</b><br>
      Recall: ${recall}<br>
      Precision: ${precision}
    </div>
  `;

  response.value="";
  pid.value="";
  startTime=null;
  renderTrainer();
}

/* ================= TREND LOGIC ================= */
function trend(values){
  if(values.length<2)return "Baseline";
  const last=values[values.length-1];
  const prev=values[values.length-2];
  if(last===prev)return "Stable";
  if((prev==="Unstable"||prev==="Developing") &&
     (last==="Moderate"||last==="Clear"))return "Improving";
  return "Needs Support";
}

/* ================= TRAINER VIEW ================= */
function renderTrainer(){
  trainerTable.innerHTML="";
  Object.keys(history).forEach(id=>{
    const recalls=history[id].map(x=>x.recall);
    const precisions=history[id].map(x=>x.precision);

    const rTrend=trend(recalls);
    const pTrend=trend(precisions);

    let status="Stable";
    if(rTrend==="Improving"||pTrend==="Improving")status="Improving";
    if(rTrend==="Needs Support"||pTrend==="Needs Support")status="Needs Support";

    const tr=document.createElement("tr");
    tr.innerHTML=`
      <td>${id}</td>
      <td>${rTrend}</td>
      <td>${pTrend}</td>
      <td class="${
        status==="Improving"?"good":
        status==="Stable"?"mid":"low"
      }">${status}</td>
    `;
    trainerTable.appendChild(tr);
  });
}

renderTrainer();
</script>

</body>
</html>
